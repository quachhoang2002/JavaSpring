<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>File Upload Form</title>
</head>
<body>
<h1>File Upload Form</h1>
<form id="fileUploadForm" enctype="multipart/form-data">
    <label for="imageFile">Select an Image:</label>
    <input type="file" name="imageFile" id="imageFile" accept="image/*"><br>

    <label for="documentFile">Select a Document:</label>
    <input type="file" name="documentFile" id="documentFile"><br>

    <input type="button" value="Upload" onclick="uploadFiles()">
</form>

<div id="resultContainer">
    <!-- Result will be displayed here -->
</div>

<!-- Display uploaded image -->
<div id="imageContainer">
    <img id="uploadedImage" src="" alt="Uploaded Image">
</div>

<!-- Display image path -->
<p id="imagePath"></p>

<!-- Display file path -->
<p id="filePath"></p>

<!-- Provide download link for the document -->
<div id="documentLinkContainer">
    <!-- Document link will be displayed here -->
</div>

<script>
    function uploadFiles() {
        const formData = new FormData();
        formData.append("imageFile", document.getElementById("imageFile").files[0]);
        formData.append("documentFile", document.getElementById("documentFile").files[0]);

        fetch("/upload", {
            method: "POST",
            body: formData,
        })
        .then(response => response.text())
        .then(result => {
            // Check if the result contains the expected text
            if (result.includes("Files uploaded successfully!")) {
                const imageFileName = extractFileName(result, "Image:");
                const documentFileName = extractFileName(result, "Document:");

                // Construct the image and document URLs
                const imageUrl = `/assets/images/${imageFileName}`;
                const documentUrl = `/download/${documentFileName}`;

                // Display the uploaded image
                document.getElementById("uploadedImage").src = imageUrl;

                // Display the image path
                const imagePathElement = document.getElementById("imagePath");
                imagePathElement.textContent = `Image Path: ${imageUrl}`;

                // Display the file path
                const filePathElement = document.getElementById("filePath");
                filePathElement.textContent = `File Path: ${documentUrl}`;

                // Provide the download link for the document
                const downloadLink = `<a href="${documentUrl}" download="${documentFileName}">Download Document</a>`;
                document.getElementById("documentLinkContainer").innerHTML = downloadLink;
            } else {
                console.error("File upload failed.");
            }
        })
        .catch(error => {
            console.error("Error:", error);
        });
    }

    function extractFileName(text, prefix) {
        const startIndex = text.indexOf(prefix);
        if (startIndex !== -1) {
            const endIndex = text.indexOf(",", startIndex);
            if (endIndex !== -1) {
                return text.substring(startIndex + prefix.length, endIndex).trim();
            }
        }
        return "";
    }
</script>
</body>
</html>
